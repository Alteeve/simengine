!function(e){function t(t){for(var a,o,l=t[0],i=t[1],u=t[2],d=0,f=[];d<l.length;d++)o=l[d],r[o]&&f.push(r[o][0]),r[o]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(c&&c(t);f.length;)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,l=1;l<n.length;l++){var i=n[l];0!==r[i]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={1:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window.webpackJsonp=window.webpackJsonp||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var c=i;s.push([515,0]),n()}({159:function(e,t,n){e.exports=n.p+"images/c14.svg"},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onWheelScroll=function(e){e.scale({x:.7,y:.7}),e.position({x:.3*window.innerWidth,y:.3*window.innerHeight}),window.addEventListener("wheel",function(t){t.preventDefault();var n=e.scaleX(),a=e.getPointerPosition().x/n-e.x()/n,r=e.getPointerPosition().y/n-e.y()/n,s=t.deltaY>0?1.03*n:n/1.03;e.scale({x:s,y:s});var o={x:-(a-e.getPointerPosition().x/s)*s,y:-(r-e.getPointerPosition().y/s)*s};e.position(o),e.batchDraw()})},t.onWheelDown=function(e){var t=function(t){t.preventDefault();var n={x:e.x()+t.movementX,y:e.y()+t.movementY};e.position(n),e.batchDraw()};window.addEventListener("mousedown",function(e){1==e.button&&(e.preventDefault(),window.addEventListener("mousemove",t))}),window.addEventListener("mouseup",function(e){1==e.button&&(e.preventDefault(),window.removeEventListener("mousemove",t))})}},412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=m(n(1)),s=m(n(6)),o=m(n(2)),l=m(n(152)),i=m(n(94)),u=m(n(49)),c=m(n(19)),d=m(n(409)),f=m(n(79)),p=m(n(78)),y=m(n(139)),h=n(362);function m(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleMenu=function(e){n.setState({drawerAnchor:e.currentTarget})},n.handleDrawerClose=function(){n.setState({drawerAnchor:null})},n.state={drawerAnchor:null},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"render",value:function(){var e=this.props.classes,t=this.state.drawerAnchor,n=Boolean(t);return r.default.createElement(l.default,{position:"absolute",className:(0,s.default)(e.appBar,e["appBar-left"])},r.default.createElement(i.default,null,r.default.createElement(c.default,{variant:"title",color:"inherit",noWrap:!0},"HAos Simulation Engine"),r.default.createElement("div",null,r.default.createElement(u.default,{"aria-owns":n?"menu-appbar":null,"aria-haspopup":"true",color:"inherit",onClick:this.handleMenu},r.default.createElement(d.default,null)),r.default.createElement(h.Drawer,{open:n,onClose:this.handleDrawerClose,classes:{paper:e.drawerPaper},anchor:"left"},r.default.createElement("div",{className:e.toolbar}),r.default.createElement(h.Divider,null),r.default.createElement("div",{tabIndex:0,role:"button",onClick:this.handleDrawerClose,onKeyDown:this.handleDrawerClose},r.default.createElement("div",{className:e.fullList},r.default.createElement(f.default,null,r.default.createElement(p.default,{button:!0,onClick:this.props.saveLayout.bind(this)},r.default.createElement(y.default,{primary:"Save Layout"})))))))))}}]),t}();b.propTypes={classes:o.default.object,saveLayout:o.default.func.isRequired},t.default=b},430:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(1)),r=p(n(2)),s=n(23),o=p(n(158)),l=p(n(157)),i=p(n(156)),u=p(n(155)),c=p(n(19)),d=p(n(154)),f=p(n(153));function p(e){return e&&e.__esModule?e:{default:e}}function y(e){var t=e.classes,n=e.assetInfo,r=e.assetKey,s=e.changeStatus,p=[];if(n.children){p.push(a.default.createElement("div",{key:0},a.default.createElement("h3",null," Connected Components ")));var y=n.children,h=!0,m=!1,b=void 0;try{for(var g,v=Object.keys(y)[Symbol.iterator]();!(h=(g=v.next()).done);h=!0){var w=g.value;p.push(a.default.createElement("div",{key:w},a.default.createElement(c.default,{variant:"subheading",component:"h5"},w,"-",y[w].type," is ",1===y[w].status?a.default.createElement("span",{style:{color:"green"}},"on"):a.default.createElement("span",{style:{color:"red"}},"off"))))}}catch(e){m=!0,b=e}finally{try{!h&&v.return&&v.return()}finally{if(m)throw b}}}return a.default.createElement("div",null,a.default.createElement(o.default,{className:t.card},a.default.createElement(i.default,{title:"Selected Asset Details",style:{backgroundColor:"#e1e6ea"}}),a.default.createElement(l.default,null,a.default.createElement(c.default,{variant:"headline",component:"h2"},"Asset: ",r,"-",n.type),a.default.createElement(c.default,{component:"p"},"Status: ",1===n.status?a.default.createElement("span",{style:{color:"green"}},"on"):a.default.createElement("span",{style:{color:"red"}},"off")),a.default.createElement(c.default,{component:"p"},"Name: ",n.name),a.default.createElement(c.default,{component:"p"},"Current Load: ",n.load?n.load.toFixed(2):0),a.default.createElement(u.default,null),a.default.createElement(f.default,{control:a.default.createElement(d.default,{checked:1===n.status,"aria-label":"LoginSwitch",onChange:function(){return s(r,n)}}),label:"Toggle Status"}),a.default.createElement(u.default,null),a.default.createElement("div",{style:{maxHeight:500,overflow:"auto"}},p))))}y.propTypes={classes:r.default.object.isRequired,assetInfo:r.default.object.isRequired,assetKey:r.default.string.isRequired,changeStatus:r.default.func.isRequired},t.default=(0,s.withStyles)({card:{minWidth:320,position:"absolute",top:90,right:20},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{marginBottom:16,fontSize:14},pos:{marginBottom:12}})(y)},431:function(e,t,n){e.exports=n.p+"images/ups_monitor_2.png"},432:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(1)),s=n(33),o=c(n(2)),l=c(n(431)),i=c(n(159)),u=c(n(97));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.refs.ups.setZIndex(100),n.props.onElementSelection(n.props.assetId,n.props.asset)},n.selectSocket=function(e){n.setState({selectedSocketKey:e}),n.props.onElementSelection(e,n.props.asset.children[e])},n.updateUpsPos=function(e){n.setState({x:e.target.attrs.x,y:e.target.attrs.y}),n.props.onPosChange(n.props.assetId,e)},n.state={color:"grey",selectedSocketKey:-1,x:e.x?e.x:40,y:e.y?e.y:40,ups_monitor:null,c14:null},n.selectSocket=n.selectSocket.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image,n=new window.Image;t.src=l.default,t.onload=function(){e.setState({ups_monitor:t})},n.src=i.default,n.onload=function(){e.setState({c14:n})}}},{key:"componentWillReceiveProps",value:function(e){this.setState({x:e.x,y:e.y})}},{key:"render",value:function(){var e=this,t=[],n=r.default.createElement(s.Image,{image:this.state.c14,x:254,y:5}),a=this.props.asset.name?this.props.asset.name:"ups",o="|||||||||||||||||||||||||||||||||||";o=1e3===this.props.asset.battery?o:o.substring(o.length*(1-.001*this.props.asset.battery));var l=this.props.asset,i=10,c=5,d=0,f=!0,p=!1,y=void 0;try{for(var h,m=function(){var n=h.value;l.children[n].name="["+n+"]",t.push(r.default.createElement(u.default,{y:i,x:c,key:n,onElementSelection:function(){e.selectSocket(n)},selectable:!0,draggable:!1,asset:l.children[n],assetId:n,selected:e.state.selectedSocketKey===n&&e.props.nestedComponentSelected,powered:0!==e.props.asset.status,parentSelected:e.props.selected,hideName:!0,onPosChange:e.props.onPosChange})),c+=100,4==++d&&(i+=100,c=5)},b=Object.keys(l.children)[Symbol.iterator]();!(f=(h=b.next()).done);f=!0)m()}catch(e){p=!0,y=e}finally{try{!f&&b.return&&b.return()}finally{if(p)throw y}}return r.default.createElement(s.Group,{draggable:"true",onDragMove:this.updateUpsPos.bind(this),x:this.state.x,y:this.state.y,ref:"ups"},r.default.createElement(s.Path,{data:"M 51.551168,118.02771 H 161.85062 l 10.30629,7.10992 H 41.244884 Z M 41.225275,125.12154 H 172.17651 c 0.86917,0 1.56887,5.60194 1.56887,12.56046 v 86.52769 c 0,6.95848 -0.6997,12.56045 -1.56887,12.56045 H 41.225275 c -0.869151,0 -1.568866,-5.60197 -1.568866,-12.56045 V 137.682 c 0,-6.95852 0.699715,-12.56046 1.568866,-12.56046 z",strokeWidth:.4,stroke:this.props.selected?"blue":"grey",fill:"white",scale:{x:4,y:4},y:-575,onClick:this.handleClick.bind(this)}),r.default.createElement(s.Group,{x:250,y:130},r.default.createElement(s.Rect,{ref:"rect",width:"390",height:"210",fill:"white",stroke:this.props.selected?"blue":"grey",strokeWidth:1.4}),t),r.default.createElement(s.Text,{y:-125,x:230,text:a,fontSize:18,fontFamily:"Helvetica"}),r.default.createElement(s.Group,{x:345,y:-50},r.default.createElement(s.Image,{image:this.state.ups_monitor,onClick:this.handleClick}),r.default.createElement(s.Group,{y:50,x:18},r.default.createElement(s.Text,{text:"Output "+(this.props.asset.status?"ON":"OFF"),fontFamily:"DSEG14Modern",fontSize:16,fill:this.props.asset.status?"white":"grey"}),r.default.createElement(s.Text,{y:30,text:"Batt "+Math.floor(this.props.asset.battery/10)+"%",fontFamily:"DSEG14Modern",fontSize:16,fill:this.props.asset.status?"white":"grey"}),r.default.createElement(s.Text,{y:30,x:110,text:o,fontSize:16,fill:this.props.asset.status?"white":"grey"}))),n)}}]),t}();t.default=d,d.propTypes={name:o.default.string,x:o.default.number,y:o.default.number,onPosChange:o.default.func.isRequired,asset:o.default.object.isRequired,assetId:o.default.string.isRequired,selected:o.default.bool.isRequired,onElementSelection:o.default.func.isRequired,nestedComponentSelected:o.default.bool.isRequired}},433:function(e,t,n){e.exports=n.p+"images/server-front.svg"},434:function(e,t,n){e.exports=n.p+"images/power-supply.svg"},435:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=u(n(1)),s=n(33),o=u(n(434)),l=u(n(96)),i=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.handleClick=function(){n.props.selectable&&n.props.onElementSelection(n.props.assetId,n.props.asset)},n.updateSocketPos=function(e){n.setState({x:e.target.attrs.x,y:e.target.attrs.y}),n.props.onPosChange(n.props.assetId,e)},n.state={image:null,color:"grey",x:e.x?e.x:40,y:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image;t.src=o.default,t.onload=function(){e.setState({image:t})}}},{key:"render",value:function(){var e=this.state.color;return this.props.selectable&&(e=this.props.selected||this.props.parentSelected?"blue":"grey"),r.default.createElement(s.Group,{x:this.state.x,y:this.state.y,onDragMove:this.updateSocketPos.bind(this)},r.default.createElement(s.Image,{image:this.state.image,stroke:e,onClick:this.handleClick}),this.props.selectable&&r.default.createElement(l.default,{socketOn:this.props.red_means_on?!this.props.asset.status:this.props.asset.status,powered:this.props.powered}),r.default.createElement(s.Text,{text:this.props.asset&&this.props.asset.name?this.props.asset.name:"socket",y:this.state.bgImage?175:105}))}}]),t}();t.default=c,c.defaultProps={red_means_on:!1},c.propTypes={x:i.default.number,onPosChange:i.default.func,powered:i.default.bool.isRequired,asset:i.default.object,assetId:i.default.string,selected:i.default.bool,parentSelected:i.default.bool,onElementSelection:i.default.func,selectable:i.default.bool.isRequired,red_means_on:i.default.bool}},436:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=c(n(1)),s=n(33),o=c(n(2)),l=c(n(96)),i=c(n(435)),u=c(n(433));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.refs.server.setZIndex(100),n.props.onElementSelection(n.props.assetId,n.props.asset)},n.selectSocket=function(e){n.setState({selectedPsuKey:e}),n.props.onElementSelection(e,n.props.asset.children[e])},n.updateServerPos=function(e){n.setState({x:e.target.attrs.x,y:e.target.attrs.y}),n.props.onPosChange(n.props.assetId,e)},n.state={color:"grey",selectedPsuKey:-1,x:e.x?e.x:40,y:e.y?e.y:40,frontimg:null},n.selectSocket=n.selectSocket.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image;t.src=u.default,t.onload=function(){e.setState({frontimg:t})}}},{key:"componentWillReceiveProps",value:function(e){this.setState({x:e.x,y:e.y})}},{key:"render",value:function(){var e=this,t=[],n=50,a=this.props.asset.name?this.props.asset.name:"ups",o=this.props.asset,u=!0,c=!1,d=void 0;try{for(var f,p=function(){var a=f.value;o.children[a].name="["+a+"]",t.push(r.default.createElement(i.default,{x:n,key:a,onElementSelection:function(){e.selectSocket(a)},selectable:!0,draggable:!1,asset:o.children[a],assetId:a,selected:e.state.selectedPsuKey===a&&e.props.nestedComponentSelected,powered:e.props.powered,parentSelected:e.props.selected})),n+=240},y=Object.keys(o.children)[Symbol.iterator]();!(u=(f=y.next()).done);u=!0)p()}catch(e){c=!0,d=e}finally{try{!u&&y.return&&y.return()}finally{if(c)throw d}}return r.default.createElement(s.Group,{draggable:"true",onDragMove:this.updateServerPos.bind(this),x:this.state.x,y:this.state.y,ref:"server"},r.default.createElement(s.Path,{data:"m 7.84681,135.86767 h 194.30638 c 1.28966,0 2.3279,1.85111 2.3279,4.15049 v 28.5923 c 0,2.29937 -1.03824,4.15049 -2.3279,4.15049 H 7.84681 c -1.289654,0 -2.327895,-1.85112 -2.327895,-4.15049 v -28.5923 c 0,-2.29938 1.038241,-4.15049 2.327895,-4.15049 z M 22.554872,124.18558 H 187.44512 l 15.40721,11.70857 H 7.147672 Z",strokeWidth:.4,stroke:this.props.selected?"blue":"grey",fill:"white",scale:{x:4,y:4},y:-575,onClick:this.handleClick.bind(this)}),r.default.createElement(s.Text,{y:-100,text:a,fontSize:18,fontFamily:"Helvetica"}),t,r.default.createElement(s.Image,{image:this.state.frontimg,x:550,y:-20,onClick:this.handleClick}),r.default.createElement(l.default,{socketOn:this.props.asset.status,powered:this.props.powered}))}}]),t}();t.default=d,d.propTypes={x:o.default.number,y:o.default.number,onPosChange:o.default.func.isRequired,powered:o.default.bool.isRequired,name:o.default.string,asset:o.default.object.isRequired,assetId:o.default.string.isRequired,selected:o.default.bool.isRequired,onElementSelection:o.default.func.isRequired,nestedComponentSelected:o.default.bool.isRequired}},437:function(e,t,n){e.exports=n.p+"images/socket.svg"},438:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=u(n(1)),s=n(33),o=u(n(97)),l=u(n(2)),i=u(n(159));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleClick=function(){n.refs.pdu.setZIndex(100),n.props.onElementSelection(n.props.assetId,n.props.asset)},n.selectSocket=function(e){n.setState({selectedSocketKey:e}),n.props.onElementSelection(e,n.props.asset.children[e])},n.updatePduPos=function(e){n.setState({x:e.target.attrs.x,y:e.target.attrs.y}),n.props.onPosChange(n.props.assetId,e)},n.state={color:"grey",selectedSocketKey:-1,x:e.x?e.x:40,y:e.y?e.y:40,c14:null},n.selectSocket=n.selectSocket.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image;t.src=i.default,t.onload=function(){e.setState({c14:t})}}},{key:"componentWillReceiveProps",value:function(e){this.setState({x:e.x,y:e.y})}},{key:"render",value:function(){var e=this,t=[],n=r.default.createElement(s.Image,{image:this.state.c14,x:-70}),a=100,l=this.props.asset.name?this.props.asset.name:"pdu",i=this.props.asset,u=Math.round(i.load);u=u>9?""+u:"0"+u;var c=!0,d=!1,f=void 0;try{for(var p,y=function(){var n=p.value;i.children[n].name="["+n+"]",t.push(r.default.createElement(o.default,{x:a,key:n,onElementSelection:function(){e.selectSocket(n)},selectable:!0,draggable:!1,asset:i.children[n],assetId:n,selected:e.state.selectedSocketKey===n&&e.props.nestedComponentSelected,powered:0!==e.props.asset.status,parentSelected:e.props.selected,onPosChange:e.props.onPosChange})),a+=90},h=Object.keys(i.children)[Symbol.iterator]();!(c=(p=h.next()).done);c=!0)y()}catch(e){d=!0,f=e}finally{try{!c&&h.return&&h.return()}finally{if(d)throw f}}return r.default.createElement(s.Group,{draggable:"true",onDragMove:this.updatePduPos.bind(this),x:this.state.x,y:this.state.y,ref:"pdu"},r.default.createElement(s.Path,{data:"M -27.214914,140.21439 H 253.08991 c 1.86045,0 3.3582,1.41492 3.3582,3.17248 v 21.85487 c 0,1.75755 -1.49775,3.17248 -3.3582,3.17248 H -27.214914 c -1.860445,0 -3.358203,-1.41493 -3.358203,-3.17248 v -21.85487 c 0,-1.75756 1.497758,-3.17248 3.358203,-3.17248 z M -5.9971812,128.5323 H 231.87216 l 22.22631,11.70857 H -28.223485 Z",strokeWidth:.4,stroke:this.props.selected?"blue":"grey",fill:"white",scale:{x:4,y:4},y:-575,onClick:this.handleClick.bind(this)}),r.default.createElement(s.Text,{y:-85,text:l,fontSize:18,fontFamily:"Helvetica"}),r.default.createElement(s.Group,{y:15,x:845},r.default.createElement(s.Rect,{width:60,height:60,fill:"#4d4d4d",stroke:"black"}),r.default.createElement(s.Text,{y:10,x:5,text:u,fontFamily:"DSEG7Modern",fontSize:30,fill:this.props.asset.status?"yellow":"grey"}),r.default.createElement(s.Text,{y:65,x:8,text:"AMPS"})),n,t)}}]),t}();t.default=c,c.propTypes={x:l.default.number,y:l.default.number,onPosChange:l.default.func.isRequired,powered:l.default.bool.isRequired,name:l.default.string,asset:l.default.object.isRequired,assetId:l.default.string.isRequired,selected:l.default.bool.isRequired,onElementSelection:l.default.func.isRequired,nestedComponentSelected:l.default.bool.isRequired}},497:function(e,t,n){e.exports=n.p+"images/grid.png"},506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),o=v(s),l=n(33),i=v(n(497)),u=v(n(2)),c=n(23),d=v(n(163)),f=v(n(438)),p=v(n(97)),y=v(n(436)),h=v(n(432)),m=v(n(430)),b=v(n(412)),g=n(181);function v(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={assets:null,selectedAssetKey:0,connections:{},socketOffline:!0,changesSaved:!1},e.connectToSocket(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.Component),r(t,[{key:"componentDidMount",value:function(){var e=this.refs.stage.getStage();(0,g.onWheelScroll)(e),(0,g.onWheelDown)(e)}},{key:"connectToSocket",value:function(){var e=this;if("WebSocket"in window){var t="",n=window.location;t="https:"===n.protocol?"wss:":"ws:",t+="//"+n.hostname+":8000/simengine",this.ws=new WebSocket(t),this.ws.onopen=function(){e.setState({socketOffline:!1})},this.ws.onmessage=function(t){var n=JSON.parse(t.data);if(n&&"key"in n){var r=a({},e.state.assets);if(e.state.assets[n.key]){var s=a({},r[n.key]);r[n.key]=a({},s,n.data)}else{var o=e._get_parent_key(n.key),l=a({},r[o].children[n.key]);r[o].children[n.key]=a({},l,n.data)}e.setState({assets:r})}else if(n&&"assets"in n){var i={},u=n.assets;Object.keys(u).map(function(t){var n=u[t].x?u[t].x:40,a=u[t].y?u[t].y:0,r=0;if(u[t].parent){var s=!0,o=!1,l=void 0;try{for(var c,d=u[t].parent[Symbol.iterator]();!(s=(c=d.next()).done);s=!0){var f=c.value,p=0,y=0;if(u[f.key])p=u[f.key].x?u[f.key].x:50,y=u[f.key].y?u[f.key].y:50;else{var h=e._get_parent_key(f.key);p=u[h].children[f.key].x,y=u[h].children[f.key].y}i[f.key]={x:p,y:y,x1:n+r,y1:a,ckey:t},r+=250}}catch(e){o=!0,l=e}finally{try{!s&&d.return&&d.return()}finally{if(o)throw l}}}}),e.setState({assets:u,connections:i})}if(n&&n.stageLayout){var c=e.refs.stage.getStage();c.position({x:n.stageLayout.x,y:n.stageLayout.y}),c.scale({x:n.stageLayout.scale,y:n.stageLayout.scale})}}.bind(this),this.ws.onclose=function(){e.setState({socketOffline:!0}),setTimeout(function(){e.connectToSocket()},5e3)}.bind(this)}else alert("WebSocket NOT supported by your Browser!")}},{key:"_get_parent_key",value:function(e){var t=""+e;return t.substring(0,1===t.length?1:t.length-1)}},{key:"_get_asset_by_key",value:function(e){if(e&&!this.state.assets[e]){var t=this._get_parent_key(e);return this.state.assets[t].children[e]}return this.state.assets[e]}},{key:"_update_wiring",value:function(e,t,n,r){var s={},o=this.state.connections;if(e.parent){var l=!0,i=!1,u=void 0;try{for(var c,d=e.parent[Symbol.iterator]();!(l=(c=d.next()).done);l=!0){var f=c.value;s[f.key]=a({},o[f.key],{x1:n,y1:r}),n+=250}}catch(e){i=!0,u=e}finally{try{!l&&d.return&&d.return()}finally{if(i)throw u}}}else t in o&&(s[t]=a({},o[t],{x:n,y:r}));return s}},{key:"onPosChange",value:function(e,t){var n=this._get_asset_by_key(e),r=this.state.connections,s=this._update_wiring(n,e,t.target.x(),t.target.y()),o={},l=a({},this.state.assets),i=a({},l[e]);if(l[e]=a({},i,{x:t.target.x(),y:t.target.y()}),n.children&&"pdu"==n.type){var u=100,c=!0,d=!1,f=void 0;try{for(var p,y=Object.keys(n.children)[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var h=p.value,m=this._update_wiring(this._get_asset_by_key(h),h,t.target.x()+u,t.target.y());Object.assign(o,m),u+=90}}catch(e){d=!0,f=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw f}}}else if(n.children&&"ups"==n.type){var b=250,g=150,v=0,w=!0,k=!1,_=void 0;try{for(var x,S=Object.keys(n.children)[Symbol.iterator]();!(w=(x=S.next()).done);w=!0){var E=x.value,O=this._update_wiring(this._get_asset_by_key(E),E,t.target.x()+b,t.target.y()+g);Object.assign(o,O),b+=100,4==++v&&(g+=100,b=250)}}catch(e){k=!0,_=e}finally{try{!w&&S.return&&S.return()}finally{if(k)throw _}}}this.setState({assets:l,connections:a({},r,s,o)})}},{key:"onElementSelection",value:function(e,t){this.setState(function(n){return{selectedAssetKey:n.selectedAssetKey===e?0:e,selectedAsset:t}})}},{key:"changeStatus",value:function(e,t){var n=a({},t);n.status=!n.status,this.ws.send(JSON.stringify({request:"power",key:e,data:n}))}},{key:"saveLayout",value:function(){var e={},t=this.state,n=t.assets,a=t.connections,r=this.refs.stage.getStage(),s={scale:r.scaleX(),x:r.x(),y:r.y()};e.stage=s,e.assets={},Object.keys(n).map(function(t){return e.assets[t]={x:n[t].x,y:n[t].y}}),Object.keys(a).map(function(t){n[t]||(e.assets[t]={x:a[t].x,y:a[t].y})}),this.ws.readyState==this.ws.OPEN&&(this.ws.send(JSON.stringify({request:"layout",data:e})),this.setState({changesSaved:!0}))}},{key:"drawSocket",value:function(e,t){var n=!t.parent||this._get_asset_by_key(t.parent[0].key).status;return o.default.createElement(p.default,{onPosChange:this.onPosChange.bind(this),onElementSelection:this.onElementSelection.bind(this),assetId:e,key:e,asset:t,selectable:!0,selected:this.state.selectedAssetKey===e,draggable:!0,powered:0!==n,x:t.x,y:t.y})}},{key:"drawPdu",value:function(e,t){var n=!!t.parent&&this._get_asset_by_key(t.parent[0].key).status;return o.default.createElement(f.default,{onPosChange:this.onPosChange.bind(this),onElementSelection:this.onElementSelection.bind(this),assetId:e,key:e,asset:t,selected:this.state.selectedAssetKey===e,nestedComponentSelected:this.state.selectedAssetKey in t.children,powered:0!==n,x:t.x,y:t.y})}},{key:"drawServer",value:function(e,t){var n=this,a=!1;return t.parent&&(a=void 0!==t.parent.find(function(e){return 0!=n._get_asset_by_key(e.key).status})),o.default.createElement(y.default,{onPosChange:this.onPosChange.bind(this),onElementSelection:this.onElementSelection.bind(this),assetId:e,key:e,asset:t,selected:this.state.selectedAssetKey===e,nestedComponentSelected:this.state.selectedAssetKey in t.children,powered:a,x:t.x,y:t.y})}},{key:"drawUps",value:function(e,t){var n=this,a=!1;return t.parent&&(a=void 0!==t.parent.find(function(e){return 0!=n._get_asset_by_key(e.key).status})),o.default.createElement(h.default,{onPosChange:this.onPosChange.bind(this),onElementSelection:this.onElementSelection.bind(this),assetId:e,key:e,asset:t,selected:this.state.selectedAssetKey===e,nestedComponentSelected:this.state.selectedAssetKey in t.children,powered:0!==a,x:t.x,y:t.y})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.assets,r=n.connections,s=a?this._get_asset_by_key(this.state.selectedAssetKey):null,u=[],c=[];if(a){var f=!0,p=!1,y=void 0;try{for(var h,g=Object.keys(a)[Symbol.iterator]();!(f=(h=g.next()).done);f=!0){var v=h.value;"outlet"==a[v].type||"staticasset"===a[v].type?u.push(this.drawSocket(v,a[v])):"pdu"===a[v].type?u.push(this.drawPdu(v,a[v])):"server"===a[v].type||"serverwithbmc"===a[v].type?u.push(this.drawServer(v,a[v])):"ups"===a[v].type&&u.push(this.drawUps(v,a[v]))}}catch(e){p=!0,y=e}finally{try{!f&&g.return&&g.return()}finally{if(p)throw y}}var w=!0,k=!1,_=void 0;try{for(var x,S=Object.keys(r)[Symbol.iterator]();!(w=(x=S.next()).done);w=!0){var E=x.value,O=35,P=34,C=this._get_asset_by_key(E),j=this.state.assets[r[E].ckey].type;"staticasset"==j?P=-35:"server"==j||"serverwithbmc"===j?P=-220:"ups"==j&&(P=-300,O=45),c.push(o.default.createElement(l.Line,{points:[r[E].x+34,r[E].y+35,r[E].x1-P,r[E].y1+O],stroke:1===C.status?"green":"grey",strokeWidth:5,zIndex:300,key:""+E+r[E].ckey}))}}catch(e){k=!0,_=e}finally{try{!w&&S.return&&S.return()}finally{if(k)throw _}}}var I={vertical:"bottom",horizontal:"left"};return o.default.createElement("div",{className:t.root},o.default.createElement("div",{className:t.appFrame},o.default.createElement(b.default,{saveLayout:this.saveLayout.bind(this),classes:t}),o.default.createElement("main",{className:t.content,style:{backgroundImage:"url("+i.default+")",backgroundRepeat:"repeat",backgroundSize:"auto"}},o.default.createElement("div",{className:t.toolbar}),o.default.createElement(l.Stage,{width:window.innerWidth,height:.88*window.innerHeight,ref:"stage"},o.default.createElement(l.Layer,null,u,c)),this.state.selectedAssetKey?o.default.createElement(m.default,{assetInfo:s,assetKey:this.state.selectedAssetKey,changeStatus:this.changeStatus.bind(this)}):"",o.default.createElement(d.default,{anchorOrigin:I,open:this.state.socketOffline,message:o.default.createElement("span",null,"Socket is unavailable: trying to reconnect...")}),o.default.createElement(d.default,{anchorOrigin:I,open:this.state.changesSaved,onClose:function(){return e.setState({changesSaved:!1})},autoHideDuration:1500,message:o.default.createElement("span",null,"Changes saved!")}),o.default.createElement(d.default,{anchorOrigin:I,open:!this.state.socketOffline&&!a,message:o.default.createElement("span",null,"The system toplology appears to be empty. ",o.default.createElement("br",null)," Please, refer to the documentation (System Modelling ",o.default.createElement("a",{href:"https://simengine.readthedocs.io/en/latest/SystemModeling/"},"link"),")")}))))}}]),t}();w.propTypes={classes:u.default.object},t.default=(0,c.withStyles)(function(e){return{root:{flexGrow:1},appFrame:{zIndex:1,overflow:"hidden",position:"relative",display:"flex",width:"100%"},appBar:{width:"100%"},"appBar-left":{backgroundColor:"#36454F",marginLeft:240},drawerPaper:{width:240},toolbar:e.mixins.toolbar,content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit},menuButton:{marginLeft:-12,marginRight:20},list:{width:250}}})(w)},514:function(e,t,n){"use strict";var a=o(n(1)),r=o(n(18)),s=o(n(506));function o(e){return e&&e.__esModule?e:{default:e}}n(529),n(524),r.default.render(a.default.createElement(s.default,null),document.getElementById("app"))},515:function(e,t,n){e.exports=n(514)},524:function(e,t){},96:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(1)),r=n(33),s=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.powered,n=e.socketOn,s=e.x,o=e.y,l=t?n?"green":"red":"grey";return a.default.createElement(r.Rect,{x:s,y:o,width:10,height:10,fill:l,shadowBlur:5})}l.defaultProps={red_means_on:!1,y:85,x:20},l.propTypes={x:s.default.number,y:s.default.number,socketOn:s.default.number.isRequired,powered:s.default.bool.isRequired},t.default=l},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=u(n(1)),s=n(33),o=u(n(437)),l=u(n(96)),i=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(n.handleClick=function(){n.props.selectable&&n.props.onElementSelection(n.props.assetId,n.props.asset)},n.updateSocketPos=function(e){n.refs.socket.setZIndex(100),n.setState({x:e.target.attrs.x,y:e.target.attrs.y}),n.props.onPosChange(n.props.assetId,e)},n.state={image:null,color:"grey",x:e.x?e.x:40,y:e.y?e.y:0,bgImage:null},e.asset&&"imgUrl"in e.asset){var a=new window.Image;a.src=e.asset.imgUrl,a.onload=function(){var e=a.height;a.height=160,a.width=a.width/(e/160),n.setState({bgImage:a})}}return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default.Component),a(t,[{key:"componentDidMount",value:function(){var e=this,t=new window.Image;t.src=o.default,t.onload=function(){e.setState({image:t})}}},{key:"componentWillReceiveProps",value:function(e){this.setState({x:e.x,y:e.y})}},{key:"render",value:function(){var e=this.state.color;return this.props.selectable&&(e=this.props.selected||this.props.parentSelected?"blue":"grey"),r.default.createElement(s.Group,{x:this.state.x,y:this.state.y,draggable:this.props.draggable,onDragMove:this.updateSocketPos.bind(this),ref:"socket"},null!==this.state.bgImage&&r.default.createElement(s.Image,{image:this.state.bgImage,stroke:e,onClick:this.handleClick}),r.default.createElement(s.Image,{image:this.state.image,stroke:e,onClick:this.handleClick}),this.props.selectable&&r.default.createElement(l.default,{socketOn:this.props.red_means_on?!this.props.asset.status:this.props.asset.status,powered:this.props.powered}),!this.props.hideName&&r.default.createElement(s.Text,{fontSize:14,fontFamily:"Helvetica",text:this.props.asset&&this.props.asset.name?this.props.asset.name:"socket",y:this.state.bgImage?175:105}))}}]),t}();t.default=c,c.defaultProps={red_means_on:!1},c.propTypes={x:i.default.number,y:i.default.number,onPosChange:i.default.func.isRequired,powered:i.default.bool.isRequired,draggable:i.default.bool,red_means_on:i.default.bool,asset:i.default.object,assetId:i.default.string,selected:i.default.bool,parentSelected:i.default.bool,onElementSelection:i.default.func,selectable:i.default.bool.isRequired,hideName:i.default.bool}}});
//# sourceMappingURL=main.js.map